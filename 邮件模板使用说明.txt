===============================================
    PDF加密邮件发送系统 - 邮件模板使用说明
===============================================

一、邮件模板文件说明
===============================================

本系统支持通过txt文件自定义邮件内容，包含两个模板文件：

1. email_subject_template.txt  - 邮件主题模板
2. email_template.txt          - 邮件正文模板


二、可用变量说明
===============================================

在模板文件中，可以使用以下变量（用花括号包围）：

{folder_name}       - 文件夹名称（如：铜梁公司、酉阳公司）
{recipient_name}    - 收件人名称（来自Excel配置表）
{file_count}        - PDF文件数量
{password}          - 加密密码


三、邮件主题模板（email_subject_template.txt）
===============================================

当前内容：
{folder_name} - 加密报告文件

修改示例：
【{folder_name}】水质检测报告
{folder_name} - {file_count}份加密文件
[报告] {folder_name} 月度检测数据


四、邮件正文模板（email_template.txt）
===============================================

当前内容：
您好，{recipient_name}：

这是本月的报告文件，共 {file_count} 个PDF文件。

所有文件已加密，密码为: {password}

请及时查收！

---
此邮件由系统自动发送，请勿回复。


修改示例1（正式版）：
尊敬的{recipient_name}负责人：

您好！

本月水质检测报告已完成，现将加密文件发送给您，共计 {file_count} 份PDF文档。

文件解密密码：{password}
请妥善保管密码，及时下载查阅。

如有疑问，请联系我们。

---
重庆市水务集团
自动发送系统


修改示例2（简洁版）：
{recipient_name}，您好！

附件为本月报告共{file_count}个文件，解密密码：{password}

请查收。


五、使用步骤
===============================================

1. 用文本编辑器打开模板文件
   - Windows: 右键 → 打开方式 → 记事本
   - Linux: nano email_template.txt 或 vim email_template.txt

2. 修改模板内容
   - 保留需要的变量（{folder_name}、{recipient_name}等）
   - 修改其他文字内容
   - 注意：变量名必须准确，包括花括号

3. 保存文件
   - 确保文件编码为 UTF-8
   - 文件名不要修改

4. 运行程序测试
   - Linux: ./run.sh
   - Windows: run.bat


六、注意事项
===============================================

1. 变量格式
   ✓ 正确：{password}
   ✗ 错误：{ password }  （有空格）
   ✗ 错误：{Password}    （大小写错误）

2. 文件编码
   - 必须使用 UTF-8 编码
   - 避免使用Windows记事本（可能产生BOM）
   - 推荐使用 Notepad++、VSCode、Sublime Text

3. 特殊字符
   - 如需使用花括号作为普通字符，使用 {{ 和 }}
   - 例如：{{这不是变量}}  → 显示为：{这不是变量}

4. 备份
   - 修改前建议备份原文件
   - 如果模板文件读取失败，系统会自动使用默认模板


七、测试邮件模板
===============================================

1. 修改模板文件后，建议先测试发送

2. 在Excel配置表中只保留一个测试条目

3. 将收件邮箱改为自己的邮箱

4. 运行程序，检查收到的邮件格式是否正确

5. 确认无误后，再恢复正常配置


八、常见问题
===============================================

Q1: 修改了模板，但邮件内容没变？
A1: 检查文件是否保存，文件名是否正确，是否在正确的目录下

Q2: 邮件显示 {password} 而不是实际密码？
A2: 变量名拼写错误或格式不对，检查花括号和变量名

Q3: 邮件出现乱码？
A3: 文件编码不是UTF-8，用支持UTF-8的编辑器重新保存

Q4: 想恢复默认模板怎么办？
A4: 删除或重命名模板文件，程序会自动使用内置默认模板


九、技术支持
===============================================

如遇问题，请检查：
1. 模板文件是否存在
2. 文件编码是否为 UTF-8
3. 变量名是否正确
4. 查看程序运行时的提示信息

GitHub: https://github.com/macrossfev/report-sending
